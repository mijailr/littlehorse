"use strict";(self.webpackChunklh_site=self.webpackChunklh_site||[]).push([[5461],{3244:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var s=n(4848),r=n(8453);const i={},a="Quickstart Reference",o={id:"platform/lh-cluster-quickstart",title:"Quickstart Reference",description:"This page assumes that you have already installed the operator into your kubernetes cluster. It is intended to provide a series of minimal examples that can get you started. Additional support is available from the LittleHorse team, and additional documentation is coming soon.",source:"@site/docs/07-platform/02-lh-cluster-quickstart.md",sourceDirName:"07-platform",slug:"/platform/lh-cluster-quickstart",permalink:"/docs/platform/lh-cluster-quickstart",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Install Operator",permalink:"/docs/platform/install-operator"},next:{title:"LittleHorse API Reference",permalink:"/docs/api"}},l={},c=[{value:"Requirements",id:"requirements",level:2},{value:"Basic Cluster",id:"basic-cluster",level:2},{value:"OpenShift Sample",id:"openshift-sample",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"quickstart-reference",children:"Quickstart Reference"}),"\n",(0,s.jsxs)(t.p,{children:["This page assumes that you have already ",(0,s.jsx)(t.a,{href:"/docs/platform/install-operator",children:"installed"})," the operator into your kubernetes cluster. It is intended to provide a series of minimal examples that can get you started. Additional support is available from the LittleHorse team, and additional documentation is coming soon."]}),"\n",(0,s.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"0.5.1"})," version of LH Platform currently requires:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"name"})," of a Strimzi ",(0,s.jsx)(t.code,{children:"Kafka"})," cluster, and a port number which it can be accessed on."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"name"})," of a ",(0,s.jsx)(t.code,{children:"StorageClass"})," that can be used to provision Persistent Volumes."]}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsx)(t.p,{children:'Although te current version requires a Strimzi Kafka cluster, future versions will support other Kafka providers (such as MSK or Confluent) We will also support a "littlehorse-managed kafka" option in which the LH Platform Operator itself manages Kafka.'})}),"\n",(0,s.jsx)(t.h2,{id:"basic-cluster",children:"Basic Cluster"}),"\n",(0,s.jsxs)(t.p,{children:["In this section, we will discuss the most basic ",(0,s.jsx)(t.code,{children:"LHCluster"})," possible."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:'apiVersion: littlehorse.io/v1\nkind: LHCluster\nmetadata:\n  name: basic-cluster\n  namespace: my-namespace\nspec:\n  server:\n    listeners:\n    # Configure exposed ports on the LH Server.\n    - name: internal\n      port: 2023\n    image: public.ecr.aws/littlehorse/lh-server:0.7.2\n    imagePullPolicy: IfNotPresent\n    hotStandbyReplicas: 1 # Configure hot standby replicas for high availabiltiy\n    replicas: 1\n    storage:\n      storageClassName: "standard" # TODO: Replace with your storage class\n      volumeSize: "10G" # required\n\n  kafka:\n    # Specify replication factor of 3 for all LH topics, and use 12 partitions\n    # for each topic. Note: There are 6 topics, so this config uses 72 partitions total.\n    replicationFactor: 3\n    clusterPartitions: 12\n\n    # Tell LittleHorse how to access Kafka\n    strimziClusterRef:\n      clusterName: \'lh-kafka\' # Replace with name of your Strimzi cluster\n      createTopics: true\n\n      # assumes that the Strimzi Kafka port is plaintext with no authentication\n      listener:\n        tls: false\n        authentication: NONE\n        port: 9093\n'})}),"\n",(0,s.jsx)(t.p,{children:"In this example, we have the following characteristics:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["There is a Strimzi ",(0,s.jsx)(t.code,{children:"Kafka"})," resource named ",(0,s.jsx)(t.code,{children:"lh-kafka"})," in the same namespace as the ",(0,s.jsx)(t.code,{children:"LHCluster"}),", with a plaintext port on ",(0,s.jsx)(t.code,{children:"9093"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["The LH Server can be contacted via the ",(0,s.jsx)(t.code,{children:"basic-cluster-server:2023"})," endpoint within the ",(0,s.jsx)(t.code,{children:"my-namespace"})," namespace."]}),"\n",(0,s.jsx)(t.li,{children:"The LH Server cannot be reached from outside the cluster."}),"\n",(0,s.jsx)(t.li,{children:"The LH Server does not have authentication configured."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"openshift-sample",children:"OpenShift Sample"}),"\n",(0,s.jsxs)(t.p,{children:["The following example might be appropriate for users of OpenShift who wish to access LittleHorse from outside the cluster through an OpenShift ",(0,s.jsx)(t.code,{children:"Route"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Accessing LittleHorse from outside the cluster requires some further configuration because LittleHorse Clients need to be able to address individual LH Server Instances directly. This is similar to Kafka, and I recommend this ",(0,s.jsx)(t.a,{href:"https://strimzi.io/blog/2019/04/17/accessing-kafka-part-1/",children:"fantastic blog series"})," by Strimzi."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:'apiVersion: littlehorse.io/v1\nkind: LHCluster\nmetadata:\n  name: openshift-example\n  namespace: littlehorse\nspec:\n  server:\n    listeners:\n      - name: internal\n        port: 2023\n      - name: external\n        port: 2024\n        advertisedListeners:\n          servers:\n            - host: "lh-1.littlehorse.cloud" # TODO: Configure server 1 external URL based on the OpenShift route URL\n              port: 443 # TODO: Configure server 1 port based on the OpenShift route port\n    image: public.ecr.aws/littlehorse/lh-server:0.7.2\n    imagePullPolicy: IfNotPresent\n    hotStandbyReplicas: 1\n    replicas: 1\n    storage:\n      storageClassName: "gp2" #TODO: change this to the appropriate storage class\n      volumeSize: "10Gi"\n  kafka:\n    replicationFactor: 3\n    clusterPartitions: 6\n    strimziClusterRef:\n      clusterName: \'kafka\' #TODO: change this to the appropriate strimzi cluster name\n      createTopics: true\n      listener:\n        tls: false\n        authentication: NONE\n        port: 9094 #TODO: change this to the appropriate strimzi cluster port\n'})}),"\n",(0,s.jsxs)(t.p,{children:["After creating the LH Cluster, you can create OpenShift ",(0,s.jsx)(t.code,{children:"Route"}),"s or Kubernetes ",(0,s.jsx)(t.code,{children:"Ingress"}),"es as follows:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Bootstrap: ",(0,s.jsx)(t.code,{children:"openshift-example-server"})," on port ",(0,s.jsx)(t.code,{children:"2024"})]}),"\n",(0,s.jsxs)(t.li,{children:["LittleHorse Server 1: ",(0,s.jsx)(t.code,{children:"openshift-example-server-0"})," on port ",(0,s.jsx)(t.code,{children:"2024"})]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["The advertised hosts should match the configurations from ",(0,s.jsx)(t.code,{children:"spec.server.listeners[1].advertisedListeners"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Note that you can also access the ",(0,s.jsx)(t.code,{children:"LHCluster"})," from within you OpenShift environment on the ",(0,s.jsx)(t.code,{children:"openshift-example-server:2023"})," endpoint."]}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsx)(t.p,{children:"Future documentation will show how to deploy and configure multiple servers."})})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var s=n(6540);const r={},i=s.createContext(r);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);